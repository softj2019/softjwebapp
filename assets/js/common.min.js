window.addEventListener("load", function(){
    setTimeout(loaded, 100);

}, false);

function loaded(){
    window.scrollTo(0, 1);
}

function handleFirstTab(e) {
  if (e.keyCode === 9) {
    document.body.classList.add('user-is-tabbing');

    window.removeEventListener('keydown', handleFirstTab);
    window.addEventListener('mousedown', handleMouseDownOnce);
  }
}

function handleMouseDownOnce() {
  document.body.classList.remove('user-is-tabbing');

  window.removeEventListener('mousedown', handleMouseDownOnce);
  window.addEventListener('keydown', handleFirstTab);
}

window.addEventListener('keydown', handleFirstTab);

//스크롤 이벤트
var shown = 0;
var slides = $(".main-wrap>section");
$(function () {
	$('.links>li>a').click(function (e) {
		e.preventDefault();
		var clicked = $('.links>li>a').index(this);
		var toShowSlide = slides.eq(clicked);
        var tt = toShowSlide.offset().top; //top값 
        $('.links a, .links2 a').removeClass('on');
        $(this).addClass('on');
        if(clicked > 0){
            $('.links2 a').eq(clicked - 1).addClass('on');
        }
        $('html,body').filter(":not(:animated)").animate({scrollTop:tt});
        shown = clicked;
        if(clicked == 1){ //각 섹션 애니메이션
            $('.sec2-TopL, .sec2-BotL, .sec2-TopR, .sec2-BotR').addClass('on');
            setTimeout(function(){
                new Vivus('svg', {duration: 150, start:'autostart'});
            }, 300);
            $('.sec1 .temp-left').removeClass('on');
        }else if(clicked === 0){
            $('.sec1 .temp-left').addClass('on');
            $('.sec2-TopL, .sec2-BotL, .sec2-TopR, .sec2-BotR').removeClass('on');
        }else{
            $('.sec2-TopL, .sec2-BotL, .sec2-TopR, .sec2-BotR, .sec1 .temp-left').removeClass('on');
        }
    });
	$(window).on('mousewheel DOMMouseScroll', function (event) {
//    if ( $('html,body').filter(":animated").length > 0) { return; } //애니메이션 진행 중에 발생한 휠은 무시
		if (event.originalEvent.wheelDelta > 0 || event.originalEvent.detail < 0) {
			// scroll up
			if (shown > 0) {
				$('.links>li>a').eq(shown - 1).triggerHandler("click");
			}
		} else {
			// scroll down
			if (shown < slides.length-1) {
				$('.links>li>a').eq(shown + 1).triggerHandler("click");//올라갈때	
            } 			
		}
	});
    //mobile touch
    var startX, startY, endX, endY;
    $("html,body").on('touchstart',function(event){
        startX = event.originalEvent.changedTouches[0].screenX;
        startY = event.originalEvent.changedTouches[0].screenY;
    });
    $("html,body").on('touchend',function(event){
        endX = event.originalEvent.changedTouches[0].screenX;
        endY = event.originalEvent.changedTouches[0].screenY;
    });
    $(document).on('touchend',function(){
        if(Math.abs(endY-startY) > 30){
            if(startY < endY){
                if (shown > 0) {
                    $('.links>li>a').eq(shown - 1).triggerHandler("click");
                }
            }else if(startY > endY){
                if (shown < slides.length-1) {
                    $('.links>li>a').eq(shown + 1).triggerHandler("click");//올라갈때
                }
            }else{}

        }

    });
    //link click
    $('.links2 a').click(function(e){
        e.preventDefault();
        var clicked2 = $('.links2 a').index(this)+1;
        $('.links>li>a').eq(clicked2).triggerHandler("click");
    });
    $('h1').click(function(e){
        e.preventDefault();
        $('.links>li>a').eq(0).triggerHandler("click");
    });
    //header color
    $('.links>li>a').click(function(){
        var clicked = $('.links>li>a').index(this);
        if(clicked == 1 || clicked == 2){
            $('.main-hd').addClass('dark');
        }else{
            $('.main-hd').removeClass('dark');
        }
    });
});
    
//custom cursor
var isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ? true : false;
$(document).ready(function($){
    if(isMobile) {
        $(".cursor").css('display', 'none');
    }
});
$(document).on('touchstart', function(){
    $(".cursor").css('display', 'none');
})


$(document).ready(function(){
   $(document).mousemove(function(e){
        var x = e.pageX;
        var y = e.pageY - $(document).scrollTop();
        $(".cursor").css("top", y + "px");
        $(".cursor").css("left", x + "px"); 
   });
});

if(!isMobile){
    $(document).on('mouseenter', '.links2 li a, .h-logo, .menu-btn, .slick-arrow', function(){
        $('.cursor').addClass('cursor-grow');
        $('.cursor').css('z-index', '-2');
        $(this).addClass('hovered');
    });
    $(document).on('mouseenter', '.main-navi a, .navi-close', function(){
        $('.cursor').addClass('cursor-grow2');
        $('.cursor').css('z-index', '101');
        $(this).css('z-index', '102');
    })
    $(document).on('mouseleave', '.links2 li a, .h-logo, .menu-btn, .slick-arrow, .main-navi a, .navi-close', function(){
        $('.cursor').removeClass('cursor-grow');
        $('.cursor').removeClass('cursor-grow2');
        $('.cursor').css('z-index', '1000');
        $(this).removeClass('hovered');
    });
}
$(function () {
    $('.menu-btn').click(function(){
        $('.main-navi').addClass('on');
    });
    $('.main-navi a, .navi-close').click(function(){
        $('.main-navi').removeClass('on');
    });
});
//210927 이미지 수정
$(document).ready(function(){
    var imgant = $(".tabletimg img");
    $(imgant, this).each(function(){
        var imght2 = this.naturalHeight;
        if(imght2 <= 1455)
        $(this).css('animation','paused');
    });
    var imgan = $(".phoneimg img");
    $(imgan, this).each(function(){
        var imght = this.naturalHeight;
        if(imght <= 440)
        $(this).css('animation','paused');
    });
});